<TicketSection @id="provisions"
               @nextAction={{@nextSection}}
               @nextDisabled={{this.needAnswer}}
               @toggleCard={{@toggleCard}}
               @showing={{@showing}}>
  <:title>
    Provisions
    {{#if this.totalItems}}
      <TicketSectionStatus @status="qualified" @text="{{pluralize this.totalItems.length "item"}} will be used"/>
    {{/if}}
    {{#if this.allBankedItems}}
      <TicketSectionStatus @status="banked" @text="{{pluralize this.allBankedItems.length "item"}} banked"/>
    {{/if}}
  </:title>
  <:body>
    {{#if this.allocatedProvisions}}
      <p>
        <b>The following general provision(s) have been granted to assist with your upcoming event work:</b><br>
        (These are separate from the provisions you may have earned, may not be banked, and will expire after the
        event.)
      </p>
      <ul>
        {{#each this.allocatedProvisions as |item|}}
          <li>{{item.typeLabel}}</li>
        {{/each}}
      </ul>
    {{/if}}
    {{#if this.supersededProvisions}}
      <p>
        <b>You have earned the following {{pluralize this.supersededProvisions.length "provision"}}  however
          the item(s) will automatically be banked because a similar allocated provision(s) has been granted to you.</b>
      </p>
      <ul>
        {{#each this.supersededProvisions as |item|}}
          <li>{{item.typeLabel}}</li>
        {{/each}}
      </ul>
    {{/if}}
    {{#if this.bankedItems}}
      <p>
        <b>You have chosen to bank the following {{pluralize this.bankedItems.length "provision"}}:</b>
      </p>
      <ul>
        {{#each this.bankedItems as |item|}}
          <li>{{item.typeLabel}} expiring after {{mdy-format item.expiry_date full=true}}</li>
        {{/each}}
      </ul>
      <UiButton @class="btn-responsive" @onClick={{fn this.updateItems "claim"}} @disabled={{@isSubmitting}}>
        Use the provision(s) for this event
        {{#if @isSavingDocumentStatus}}
          <SpinIcon/>
        {{/if}}
      </UiButton>
    {{else if this.earnedProvisions}}
      <p>
        <b>Unless you state otherwise, the following earned {{pluralize this.earnedProvisions.length "provision"}}
          will automatically be used for this event:</b>
      </p>
      <ul>
        {{#each this.earnedProvisions as |item|}}
          <li>
            {{item.typeLabel}}
          </li>
        {{/each}}
      </ul>
      <p>
        You may bank the provision(s) to use in a future event if you are taking
        this year off or are planning to have a "light" Ranger schedule.
      </p>
      <UiButton @class="btn-responsive" @onClick={{fn this.updateItems "bank"}} @disabled={{@isSubmitting}}>
        Bank the provision(s)
        {{#if @isSavingDocumentStatus}}
          <SpinIcon/>
        {{/if}}
      </UiButton>
    {{/if}}
    {{#if this.submittedItems}}
      <p class="mt-2">
        The follow provisions have been submitted for processing and may not be adjusted through the Clubhouse.
      </p>
      <ul>
        {{#each this.submittedItems as |item|}}
          <li>{{item.typeLabel}} - SUBMITTED</li>
        {{/each}}
      </ul>
      <p>
        Contact the Ranger Ticketing Team if you have questions or concerns.
        {{mail-to @ticketingInfo.ranger_ticketing_email}}
      </p>
    {{/if}}
  </:body>
</TicketSection>
