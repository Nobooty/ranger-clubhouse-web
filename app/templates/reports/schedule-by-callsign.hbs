<YearSelect @title="Schedule By Callsign" @year={{this.year}} @onChange={{action (mut this.year)}}  />

{{#if this.letterOptions}}
  <p>
    Jump to callsigns starting with the letter:
  </p>
  <p>
    {{#each this.letterOptions as |letter|}}
      <a href {{on "click" (fn this.scrollToCallsign letter.id)}}
         class="d-inline-block border p-2 mr-2 mb-2">{{letter.letter}}</a>
    {{/each}}
  </p>
  <p>
    <button type="button" class="btn btn-primary " {{action this.toggleExpandAll}} disabled={{this.isExpanding}}>
      {{if this.expandAll "Hide" "Expand"}} All
    </button>
    {{#if this.isExpanding}}
      <LoadingIndicator @text="Working"/>
    {{/if}}
  </p>
{{/if}}

{{#each this.people as |person|}}
  <div class="border mb-2" id="person-{{person.id}}">
    <div class="bg-light-gray p-2">
      <a href class="h4" {{on "click" (fn this.togglePerson person)}}>
        {{fa-icon (if person.showing "caret-down" "caret-right")}} {{person.callsign}}
      </a>
    </div>
    {{#if person.showing}}
      <div class="p-2">
        <div class="ml-1">
          <LinkTo @route="person.index" @model={{person.id}} class="btn btn-secondary btn-sm">
            View {{person.callsign}}
          </LinkTo>
          <LinkTo @route="person.timesheet" @model={{person.id}} class="btn btn-secondary btn-sm" @year={{this.year}}>
            View {{this.year}} Timesheet
          </LinkTo>
        </div>
        <table class="table table-striped table-hover table-width-auto mt-2">
          <thead>
          <tr>
            <th>From</th>
            <th>To</th>
            <th>Description</th>
            <th>Position</th>
          </tr>
          </thead>

          <tbody>
          {{#each person.slots as |slot|}}
            <tr>
              <td>{{shift-format slot.begins}}</td>
              <td>{{shift-format slot.ends}}</td>
              <td>
                <PresentOrNot @value={{slot.description}} @empty="-"/>
              </td>
              <td>{{slot.position.title}}</td>
            </tr>
          {{/each}}
          </tbody>
        </table>
      </div>
    {{/if}}
  </div>
{{else}}
  <p>
    <b class="text-danger">No {{this.year}} schedules were found.</b>
  </p>
{{/each}}
